Check 388A2D3A
Auto 8224

# Run-time Variables

Var dato: Num = 12
Var g: NumArray(1000, 2) = 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
Var t: NumArray(110) = 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, -5, -8, -9, 99, 99, -6, -4, 99, -2, 99, 99, -1, -3, 99, 99, 99, 99, -11, 99, 99, -7, 99, -10, 99, -12, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99
Var e: NumArray(4) = 0, 4, 7, 12
Var x: NumArray(105) = 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
Var y: NumArray(105) = 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
Var f: NumFOR = 248, 1000, 1, 1210, 2

# End Run-time Variables

  10 REM Teclado del Spectrum
  20 POKE 23658,8
  30 GO SUB 1050: REM inicializar
  40 GO SUB 620: REM pantalla
  50 LET pt=2
  60 LET un=99
  70 POKE 23672,0: POKE 23673,0
  80 REM lazo interpretacion
  90 IF INKEY$="0" THEN GO TO 180
 100 GO SUB 330: REM nota
 110 IF no<>un AND no<>99 THEN GO SUB 500: REM punto
 120 GO SUB 420: REM efectos
 130 GO SUB 390: REM grabacion
 140 GO SUB 540: REM interpretar
 150 IF pt<1000 THEN GO TO 90
 160 CLS
 170 IF pt=1000 THEN PRINT AT 10,7;"GRABACION COMPLETA": BEEP 3,20: PAUSE 10
 180 PAPER 1: INK 7
 190 GO SUB 970: REM pregunta
 200 IF rp=0 THEN GO TO 300
 210 IF rp=1 THEN GO SUB 620: REM pantalla
 220 LET ct=2
 230 POKE 23672,0: POKE 23673,0
 240 REM lazo de reproduccion
 250 IF INKEY$="O" THEN GO TO 300
 260 GO SUB 410: REM efectos
 270 GO SUB 580: REM reproduccion
 280 IF ct<pt THEN GO TO 250
 290 GO TO 190
 300 BORDER 7: PAPER 7: INK 0
 310 CLS
 320 STOP
 330 REM nota
 340 LET t$=INKEY$
 350 LET tc= CODE (t$)+1
 360 LET no=t(tc)
 370 RETURN
 380 REM grabacion
 390 IF no<99 AND no<>g(pt,1) THEN LET g(pt,1)=no: LET g(pt,2)=PEEK 23672+256*PEEK 23673: LET pt=pt+1
 400 RETURN
 410 REM efectos
 420 IF INKEY$="1" THEN LET oc=12
 430 IF INKEY$="2" THEN LET oc=0
 440 IF INKEY$="3" THEN LET ti=1.5
 450 IF INKEY$="4" THEN LET ti=1
 460 IF INKEY$="5" THEN LET ac=1
 470 IF INKEY$="6" THEN LET ac=0
 471 IF INKEY$="7" THEN LET dt=1
 472 IF INKEY$="8" THEN LET dt=0
 480 RETURN
 490 REM punto
 500 INK 2: PAPER 6
 510 PRINT AT y(tc),x(tc);"*"
 520 RETURN
 530 REM interpretar
 540 IF no=un THEN GO TO 570
 550 LET un=no
 560 IF no<>99 THEN BEEP .3,no+oc: PRINT PAPER (y(tc)-6)*3.5;AT y(tc),x(tc);" ": REM espacio
 570 RETURN
 580 REM reproduccion
 581 IF (PEEK 23672+256*PEEK 23673)*ti>=g(ct,2) AND dt=1 THEN BEEP .15/ti,g(ct,1)+oc+2: BEEP .15/ti,g(ct,1)+oc-2: LET ct=ct+1: GO TO 610
 590 IF (PEEK 23672+256*PEEK 23673)*ti>=g(ct,2) AND ac=0 THEN BEEP .3/ti,g(ct,1)+oc: LET ct=ct+1: GO TO 610
 600 IF (PEEK 23672+256*PEEK 23673)*ti>=g(ct,2) AND ac=1 THEN FOR p=1 TO 4: BEEP .01/ti,g(ct,1)+oc+e(p): NEXT p: LET ct=ct+1
 610 RETURN
 620 REM pantalla
 630 INK 7: PAPER 1
 640 CLS
 650 PRINT AT 1,11;"SPECTRAMUSICA"
 660 PRINT AT 3,5;"ESTADO: "
 670 PRINT AT 3,13;"PREPARADO"
 680 FOR f=6 TO 8
 690 FOR g=10 TO 22
 700 PRINT PAPER 7;AT f,g;" "
 710 NEXT g
 720 NEXT f
 730 FOR f=11 TO 21 STEP 2
 740 PRINT PAPER 0;AT 6,f;" "
 750 NEXT f
 760 PRINT PAPER 7;AT 6,15;" "
 770 INK 0
 780 FOR x=91 TO 177 STEP 16
 790 PLOT x,103: DRAW 0,24
 800 PLOT x+1,103: DRAW 0,24
 810 NEXT x
 820 INK 7
 830 PRINT AT 11,3;"PULSA CUALQUIER TECLA PARA COMENZAR"
 840 IF INKEY$<>"" THEN GO TO 840
 850 IF INKEY$="" THEN GO TO 850
 860 IF rp=0 THEN PRINT AT 3,13;"GRABANDO": GO TO 880
 870 PRINT 3,13;"REPRODUCIENDO"
 880 PRINT 11,3;"PULSA 1 PARA SUBIR UNA OCTAVA"
 890 PRINT 12,3;"PULSA 2 PARA ESCALA NORMAL"
 900 PRINT 13,3;"PULSA 0 PARA SALIR"
 910 PRINT 15,10;"SOLO REPRODUCIR"
 920 PRINT 16,3;"PULSA 3 PARA SUBIR TEMPO"
 930 PRINT 17,3;"PULSA 4 PARA TEMPO NORMAL"
 940 PRINT 18,3;"PULSA 5 PARA EFECTOS"
 950 PRINT 19,3;"PULSA 6 PARA BORRAR EFECTOS"
 951 PRINT 20,3;"PULSA 7 PARA 2-TONOS"
 952 PRINT 21,3;"PULSA 8 PARA BORRAR 2-TONOS"
 960 RETURN
 970 REM Pregunta
 980 CLS
 990 PRINT AT 10,0;"QUIERES REPRODUCIRLO? (S/N)"
1000 INPUT r$
1010 IF r$<>"S" AND r$<>"N" THEN GO TO 980
1020 IF r$="S" THEN LET rp=1: GO TO 1040
1030 LET rp=0
1040 RETURN
1050 REM inicializar
1060 BORDER 1: PAPER 1: INK 7
1070 CLS
1080 PRINT AT 10,11;"ESPERA POR FAVOR"
1090 DIM g(1000,2): DIM t(110): DIM e(4): DIM x(105): DIM y(105)
1100 FOR f=1 TO 110
1110 LET t(f)=99
1120 NEXT f
1130 FOR f=67 TO 91
1140 READ dato
1150 LET t(f)=dato
1160 NEXT f
1170 FOR f=1 TO 4
1180 READ dato
1190 LET e(f)=dato
1200 NEXT f
1210 FOR f=1 TO 1000
1220 LET g(f,1)=99: LET g(f,2)=0
1230 NEXT f
1240 FOR f=67 TO 91
1250 READ dato
1260 LET y(f)=dato
1270 READ dato
1280 LET x(f)=dato
1290 NEXT f
1300 LET rp=0: LET oc=0: LET ti=1: LET ac=0
1301 LET dt=0
1310 RETURN
1315 REM ****DATOS TONO****
1320 DATA -5,-8,-9,99,99,-6,-4,99,-2,99,99,-1,-3,99,99,99,99,-11,99,99,-7,99,-10,99,-12
1340 REM ****DATOS EFECTOS****
1350 DATA 0,4,7,12
1360 REM ****DATOS POSICION****
1370 DATA 8,18,8,14,6,13,0,0,0,0,6,17,6,19,0,0
1380 DATA 6,21,0,0,0,0,8,22,8,20,0,0,0,0,0,0,0,0,6,11,0,0,0,0
1390 DATA 8,16,0,0,8,12,0,0,8,10
